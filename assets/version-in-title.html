<!-- version-in-title.html -->
<div id="title-version-control"></div>
<script>
  document.addEventListener('DOMContentLoaded', function () {
    // Find the original version control dropdown
    const originalDropdown = document.querySelector('.navbar-nav .nav-item.dropdown:has(iconify-icon[icon="qlementine-icons:version-control-16"])');
    if (originalDropdown && document.querySelector('.quarto-title')) {
      // Clone the dropdown structure
      const clonedDropdown = originalDropdown.cloneNode(true);
      // Update classes
      clonedDropdown.className = 'title-version-menu dropdown';
      // Remove the menu-text class but keep the span and its contents
      const menuTextSpan = clonedDropdown.querySelector('.menu-text');
      if (menuTextSpan) {
        menuTextSpan.classList.remove('menu-text');
      }
      // Find the title element
      const titleElement = document.querySelector('.quarto-title .title');
      if (titleElement) {
        // Add the version control to the container
        const versionContainer = document.getElementById('title-version-control');
        versionContainer.appendChild(clonedDropdown);
        titleElement.appendChild(versionContainer);

        // Check if this is the author guide and hide if it is
        if (titleElement.childNodes[0].textContent.trim() === '{{< meta demo-title >}}') {
          versionContainer.style.display = 'none';
          versionContainer.style.visibility = 'hidden';
          versionContainer.style.pointerEvents = 'none';
        }

        // Ensure Bootstrap dropdown functionality works on the clone
        if (typeof bootstrap !== 'undefined') {
          const dropdownElement = clonedDropdown.querySelector('.dropdown-toggle');
          if (dropdownElement) {
            new bootstrap.Dropdown(dropdownElement);
          }
        }
      }
    }
  });
</script>
